version: 2.1

jobs:
    components-test:
        docker:
            - image: circleci/node:14.15.0
        steps:
            - checkout
            - run: cd packages/components && npm ci
            - run: cd packages/components && npm run lint
            - run: cd packages/components && npm run test
            - run: cd packages/components && npm run build
            - run: cd packages/components && npm run build:storybook
    components-storybook-release:
        docker:
            - image: circleci/node:14.15.0
        steps:
            - checkout
            - run: ./scripts/upload-storybook.sh

workflows:
    version: 2
    test:
        jobs:
            - components-test
    components-storybook-release:
        jobs:
            - components-storybook-release:
                  filters:
                      branches:
                          only: master
