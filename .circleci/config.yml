version: 2.1

jobs:
    test-node:
        docker:
            - image: circleci/node:14.15.0
        steps:
            - checkout
            - run: cd packages/components && npm ci
            - run: cd packages/components && npm run lint
            - run: cd packages/components && npm run test
    storybook-release:
        docker:
            - image: circleci/node:14.15.0
        steps:
            - checkout
            - run: ./scripts/upload-storybook.sh

workflows:
    version: 2
    test:
        jobs:
            - test-node
    storybook-release:
        jobs:
            - storybook-release:
                  filters:
                      branches:
                          only: master
