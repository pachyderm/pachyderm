deployTarget: LOCAL

pachd:
    resources:
        requests:
            cpu: 3750m
            memory: 12Gi
        limits:
            cpu: 3750m
            memory: 12Gi
    nodeSelector:
        loadtest: enabled

etcd:
    resources:
        requests:
            cpu: 1000m
            memory: 1000M
        limits:
            cpu: 1000m
            memory: 1000M
    nodeSelector:
        loadtest: enabled

loki-stack:
    promtail:
        config:
            snippets:
                common:
                  - action: replace
                    source_labels:
                      - __meta_kubernetes_pod_node_name
                    target_label: node_name
                  - action: replace
                    source_labels:
                      - __meta_kubernetes_namespace
                    target_label: namespace
                  - action: replace
                    replacement: $1
                    separator: /
                    source_labels:
                      - namespace
                      - app
                    target_label: job
                  - action: replace
                    source_labels:
                      - __meta_kubernetes_pod_name
                    target_label: pod
                  - action: replace
                    source_labels:
                      - __meta_kubernetes_pod_container_name
                    target_label: container
                  - action: replace
                    replacement: /var/log/pods/*$1/*.log
                    separator: /
                    source_labels:
                      - __meta_kubernetes_pod_uid
                      - __meta_kubernetes_pod_container_name
                    target_label: __path__
                  - action: replace
                    regex: true/(.*)
                    replacement: /var/log/pods/*$1/*.log
                    separator: /
                    source_labels:
                      - __meta_kubernetes_pod_annotationpresent_kubernetes_io_config_hash
                      - __meta_kubernetes_pod_annotation_kubernetes_io_config_hash
                      - __meta_kubernetes_pod_container_name
                    target_label: __path__
                  - action: labelmap
                    regex: __meta_kubernetes_pod_label_(.+)  
