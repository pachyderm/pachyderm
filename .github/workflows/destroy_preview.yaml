on:
  pull_request:
    types: [closed]
jobs:
  up:
    name: remove-preview
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Helium Delete
        run: |
          echo Deleting by name: $(echo ${CURRENT_BRANCH} | sed -E 's/[._]|-npm_and_yarn-/-/g')
          curl -X DELETE -H "Authorization: Bearer ${HELIUM_API_TOKEN}" https://helium.pachyderm.io/v1/api/workspace/console-$(echo ${CURRENT_BRANCH} | sed -E 's/[._]|-npm_and_yarn-/-/g')
        env:
          HELIUM_API_TOKEN: ${{ secrets.HELIUM_API_TOKEN }}
          CURRENT_BRANCH: ${{ github.head_ref }}
